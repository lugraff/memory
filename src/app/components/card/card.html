<div *ngIf="store.state().cards[this.cardId] as card" (pointerdown)="onDown($event)" (pointerleave)="onLeave()"
  (dblclick)="onDoubleClick()" [style.transform]="'scale(' + activeScale() + ',' + activeScale() + ')'"
  [ngClass]="moving()?'':'duration-200'"
  [ngStyle]="{rotate:randomRotate()+'deg', left:card.position.x+'px', top:card.position.y+'px', zIndex:card.zIndex}"
  class="absolute select-none transform-gpu">
  <div *ngIf="card.open;else cardClosed" [ngStyle]="{
      backgroundColor:card.color, 
      width: card.size.x+'px', 
      height: card.size.y+'px'}"
    class="flex justify-center items-center duration-300 animate-flip border border-black rounded-md transform-gpu"
    [ngClass]="animCloseStarted() && card.open ? 'scale-x-0 scale-y-125' : ''">
    <img class="w-full h-full object-cover"
      [ngStyle]="{objectPosition: card.picture.offset.x+'% '+card.picture.offset.y+'%'}" [alt]="card.picture.name"
      [src]=card.picture.url>

  </div>

  <ng-template #cardClosed>
    <div class="duration-300 animate-flip border border-black rounded-md transform-gpu" [ngStyle]="{
        backgroundImage: 'url(assets/card_back_'+card.backNr+'.png)', 
        backgroundSize: card.size.x+'px ' + card.size.y+'px', 
        width: card.size.x+'px', 
        height: card.size.y+'px'}" [ngClass]="animOpenStarted() && !card.open ? 'scale-x-0 scale-y-125' : ''">
      <div
        class="absolute w-full h-full from-tertiary to-secondary bg-gradient-to-t mix-blend-overlay saturate-150 opacity-90">
      </div>
    </div>
  </ng-template>
</div>